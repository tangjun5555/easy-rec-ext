{
  "model_dir": "cvr_v1_din_v1/ckpt",
  "train_config": {
    "optimizer_config": {
      "optimizer_type": "adagrad_optimizer",
      "adagrad_optimizer": {
        "learning_rate": {
          "learning_rate_type": "exponential_decay_learning_rate",
          "exponential_decay_learning_rate": {
            "initial_learning_rate": 0.1,
            "decay_steps": 20000,
            "decay_factor": 0.95,
            "min_learning_rate": 0.001
          }
        }
      }
    }
  },
  "eval_config": {
    "auc": {
    },
    "gauc": {
      "gid_field": "client_str",
      "reduction": "mean_by_sample_num"
    },
    "pcopc": {
    }
  },
  "export_config": {
    "export_dir": "cvr_v1_din_v1/export"
  },
  "input_config": {
    "input_type": "csv",
    "num_epochs": 2,
    "batch_size": 256,
    "input_fields": [
      {
        "input_name": "label",
        "input_type": "int"
      },
      {
        "input_name": "sid",
        "input_type": "int"
      },
      {
        "input_name": "gid",
        "input_type": "int"
      },
      {
        "input_name": "rc",
        "input_type": "int"
      },
      {
        "input_name": "cc",
        "input_type": "int"
      },
      {
        "input_name": "rb",
        "input_type": "int"
      },
      {
        "input_name": "cb",
        "input_type": "int"
      },
      {
        "input_name": "color_0",
        "input_type": "float"
      },
      {
        "input_name": "color_1",
        "input_type": "float"
      },
      {
        "input_name": "color_2",
        "input_type": "float"
      },
      {
        "input_name": "color_3",
        "input_type": "float"
      },
      {
        "input_name": "color_4",
        "input_type": "float"
      },
      {
        "input_name": "color_5",
        "input_type": "float"
      },
      {
        "input_name": "color_6",
        "input_type": "float"
      },
      {
        "input_name": "color_7",
        "input_type": "float"
      },
      {
        "input_name": "color_8",
        "input_type": "float"
      },
      {
        "input_name": "color_9",
        "input_type": "float"
      },
      {
        "input_name": "color_10",
        "input_type": "float"
      },
      {
        "input_name": "color_11",
        "input_type": "float"
      },
      {
        "input_name": "color_12",
        "input_type": "float"
      },
      {
        "input_name": "color_13",
        "input_type": "float"
      },
      {
        "input_name": "color_14",
        "input_type": "float"
      },
      {
        "input_name": "color_15",
        "input_type": "float"
      },
      {
        "input_name": "color_16",
        "input_type": "float"
      },
      {
        "input_name": "color_17",
        "input_type": "float"
      },
      {
        "input_name": "color_18",
        "input_type": "float"
      },
      {
        "input_name": "discount",
        "input_type": "float"
      },
      {
        "input_name": "is_star",
        "input_type": "float"
      },
      {
        "input_name": "is_joint",
        "input_type": "float"
      },
      {
        "input_name": "is_women",
        "input_type": "float"
      },
      {
        "input_name": "is_limited",
        "input_type": "float"
      },
      {
        "input_name": "is_theme_limited",
        "input_type": "float"
      },
      {
        "input_name": "is_high",
        "input_type": "float"
      },
      {
        "input_name": "is_middle",
        "input_type": "float"
      },
      {
        "input_name": "is_low",
        "input_type": "float"
      },
      {
        "input_name": "is_indoor",
        "input_type": "float"
      },
      {
        "input_name": "is_outdoor",
        "input_type": "float"
      },
      {
        "input_name": "hour_of_day",
        "input_type": "int"
      },
      {
        "input_name": "day_of_week",
        "input_type": "int"
      },
      {
        "input_name": "scene_id",
        "input_type": "int"
      },
      {
        "input_name": "day_of_month",
        "input_type": "int"
      },
      {
        "input_name": "ab_bucket",
        "input_type": "int"
      },
      {
        "input_name": "client_str",
        "input_type": "string"
      },
      {
        "input_name": "os",
        "input_type": "int"
      },
      {
        "input_name": "manufacturer",
        "input_type": "int"
      },
      {
        "input_name": "c_gid_sequence_s",
        "input_type": "string"
      },
      {
        "input_name": "c_gid_sequence",
        "input_type": "string"
      },
      {
        "input_name": "b_1y_seq",
        "input_type": "string"
      },
      {
        "input_name": "xgb_leaf_0",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_1",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_2",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_3",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_4",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_5",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_6",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_7",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_8",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_9",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_10",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_11",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_12",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_13",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_14",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_15",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_16",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_17",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_18",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_19",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_20",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_21",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_22",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_23",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_24",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_25",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_26",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_27",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_28",
        "input_type": "int"
      },
      {
        "input_name": "xgb_leaf_29",
        "input_type": "int"
      }
    ],
    "label_fields": [
      "label"
    ]
  },
  "feature_config": {
    "feature_fields": [
      {
        "input_name": "sid",
        "feature_type": "IdFeature",
        "embedding_name": "sid_embedding",
        "embedding_dim": 32
      },
      {
        "input_name": "gid",
        "feature_type": "IdFeature",
        "embedding_name": "gid_embedding",
        "embedding_dim": 32
      },
      {
        "input_name": "rc",
        "feature_type": "IdFeature",
        "embedding_name": "rc_embedding",
        "embedding_dim": 32
      },
      {
        "input_name": "cc",
        "feature_type": "IdFeature",
        "embedding_name": "cc_embedding",
        "embedding_dim": 32
      },
      {
        "input_name": "rb",
        "feature_type": "IdFeature",
        "embedding_name": "rb_embedding",
        "embedding_dim": 32
      },
      {
        "input_name": "cb",
        "feature_type": "IdFeature",
        "embedding_name": "cb_embedding",
        "embedding_dim": 32
      },

      {
        "input_name": "color_0",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_1",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_2",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_3",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_4",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_5",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_6",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_7",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_8",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_9",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_10",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_11",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_12",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_13",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_14",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_15",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_16",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_17",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "color_18",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },

      {
        "input_name": "discount",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },

      {
        "input_name": "is_star",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_joint",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_women",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_limited",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_theme_limited",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_high",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_middle",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_low",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_indoor",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },
      {
        "input_name": "is_outdoor",
        "feature_type": "RawFeature",
        "raw_input_dim": 1
      },

      {
        "input_name": "hour_of_day",
        "feature_type": "IdFeature",
        "embedding_name": "hour_of_day_embedding",
        "embedding_dim": 16
      },
      {
        "input_name": "day_of_week",
        "feature_type": "IdFeature",
        "embedding_name": "day_of_week_embedding",
        "embedding_dim": 16
      },
      {
        "input_name": "scene_id",
        "feature_type": "IdFeature",
        "embedding_name": "scene_id_embedding",
        "embedding_dim": 16
      },

      {
        "input_name": "day_of_month",
        "feature_type": "IdFeature",
        "embedding_name": "day_of_month_embedding",
        "embedding_dim": 16,
        "num_buckets": 31
      },
      {
        "input_name": "ab_bucket",
        "feature_type": "IdFeature",
        "embedding_name": "ab_bucket_embedding",
        "embedding_dim": 16,
        "num_buckets": 100
      },

      {
        "input_name": "client_str",
        "feature_type": "IdFeature",
        "embedding_name": "client_str_embedding",
        "embedding_dim": 32,
        "hash_bucket_size": 10000000
      },
      {
        "input_name": "os",
        "feature_type": "IdFeature",
        "embedding_name": "os_embedding",
        "embedding_dim": 16
      },
      {
        "input_name": "manufacturer",
        "feature_type": "IdFeature",
        "embedding_name": "manufacturer_embedding",
        "embedding_dim": 16
      },

      {
        "input_name": "c_gid_sequence_s",
        "feature_type": "SequenceFeature",
        "embedding_name": "gid_sequence_embedding",
        "embedding_dim": 32
      },
      {
        "input_name": "c_gid_sequence",
        "feature_type": "SequenceFeature",
        "embedding_name": "gid_sequence_embedding",
        "embedding_dim": 32
      },
      {
        "input_name": "b_1y_seq",
        "feature_type": "SequenceFeature",
        "embedding_name": "sid_sequence_embedding",
        "embedding_dim": 32
      },

      {
        "input_name": "xgb_leaf_0",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_0_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_1",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_1_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_2",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_2_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_3",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_3_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_4",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_4_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_5",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_5_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_6",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_6_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_7",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_7_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_8",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_8_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_9",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_9_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_10",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_10_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_11",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_11_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_12",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_12_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_13",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_13_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_14",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_14_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_15",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_15_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_16",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_16_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_17",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_17_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_18",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_18_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_19",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_19_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_20",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_20_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_21",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_21_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_22",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_22_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_23",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_23_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_24",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_24_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_25",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_25_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_26",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_26_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_27",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_27_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_28",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_28_embedding",
        "embedding_dim": 8
      },
      {
        "input_name": "xgb_leaf_29",
        "feature_type": "IdFeature",
        "embedding_name": "xgb_leaf_29_embedding",
        "embedding_dim": 8
      }
    ]
  },
  "model_config": {
    "model_class": "din",
    "feature_groups": [
      {
        "group_name": "deep",
        "feature_names": [
          "sid", "gid", "rc", "cc", "rb", "cb",
          "color_0", "color_1", "color_2", "color_3", "color_4", "color_5", "color_6", "color_7", "color_8", "color_9", "color_10", "color_11", "color_12", "color_13", "color_14", "color_15", "color_16", "color_17", "color_18",
          "discount",
          "is_star", "is_joint", "is_women", "is_limited", "is_theme_limited", "is_high", "is_middle", "is_low", "is_indoor", "is_outdoor",
          "hour_of_day", "day_of_week", "scene_id",
          "client_str", "os", "manufacturer",
          "xgb_leaf_0", "xgb_leaf_1", "xgb_leaf_2", "xgb_leaf_3", "xgb_leaf_4", "xgb_leaf_5", "xgb_leaf_6", "xgb_leaf_7", "xgb_leaf_8", "xgb_leaf_9", "xgb_leaf_10", "xgb_leaf_11", "xgb_leaf_12", "xgb_leaf_13", "xgb_leaf_14", "xgb_leaf_15", "xgb_leaf_16", "xgb_leaf_17", "xgb_leaf_18", "xgb_leaf_19", "xgb_leaf_20", "xgb_leaf_21", "xgb_leaf_22", "xgb_leaf_23", "xgb_leaf_24", "xgb_leaf_25", "xgb_leaf_26", "xgb_leaf_27", "xgb_leaf_28", "xgb_leaf_29"
        ]
      },
      {
        "group_name": "din_1",
        "seq_att_map": {
          "key": "gid",
          "hist_seq": "c_gid_sequence_s"
        }
      },
      {
        "group_name": "din_2",
        "seq_att_map": {
          "key": "gid",
          "hist_seq": "c_gid_sequence"
        }
      },
      {
        "group_name": "din_3",
        "seq_att_map": {
          "key": "sid",
          "hist_seq": "b_1y_seq"
        }
      },
      {
        "group_name": "bias",
        "feature_names": ["day_of_month", "ab_bucket"]
      }
    ],
    "dnn_towers": [
      {
        "input_group": "deep",
        "dnn_config": {
          "hidden_units": [300, 200, 100]
        }
      }
    ],
    "din_towers": [
      {
        "input_group": "din_1",
        "din_config": {
          "hidden_units": [32, 16, 1]
        }
      },
      {
        "input_group": "din_2",
        "din_config": {
          "hidden_units": [32, 16, 1]
        }
      },
      {
        "input_group": "din_3",
        "din_config": {
          "hidden_units": [32, 16, 1]
        }
      }
    ],
    "final_dnn": {
      "hidden_units": [300, 200, 100]
    },
    "bias_tower": {
      "input_group": "bias"
    }
  }
}